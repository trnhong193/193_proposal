---
name: slide-content-mapper
description: Map proposal template content (markdown) to slide structure (JSON) for PowerPoint generation. Use when proposal template is ready and needs to be converted to slides. Creates structured JSON with slide-by-slide content mapping.
---

# Slide Content Mapper Skill

## Overview

This skill maps proposal content from markdown template (generated by proposal-content-generator) to structured slide format (JSON) ready for PowerPoint generation. It converts sections from TEMPLATE.md into slide-by-slide structure following SLIDE_TEMPLATE.md.

## Resources Available

This skill includes the following resources (loaded as needed):

- **SLIDE_TEMPLATE.md**: Slide structure template - Contains mapping rules from TEMPLATE.md sections to slide types
- **scripts/map_to_slides.py**: Main script to convert markdown proposal to slide structure JSON

## When to Use This Skill

Use this skill when:
- Proposal template (markdown) is ready (from proposal-content-generator)
- User wants to convert proposal to PowerPoint slides
- Proposal content needs to be structured for slide generation
- Architecture diagram is available (optional, for architecture slides)

## Process

### Step 1: Parse Proposal Template

Read the proposal template markdown file and extract:
- **Project Name**: From proposal title
- **Client Name**: From Project Requirement Statement
- **Sections**: All sections from TEMPLATE.md (Cover Page, Project Requirement, Scope of Work, etc.)

**How to parse:**
1. Use Python to read markdown file
2. Parse sections using markdown headers (## Section Name)
3. Extract content from each section

### Step 2: Map Sections to Slides

Following SLIDE_TEMPLATE.md, map each section to appropriate slide(s):

- **Cover Page** → Slide 1 (title slide)
- **Project Requirement Statement** → Slide 2 (content_table or content_bullets)
- **Scope of Work** → Slide 3-4 (two_column)
- **System Architecture** → Slide 5-6 (diagram + description)
- **System Requirements** → Slide 7-10 (multiple content slides)
- **Implementation Plan** → Slide 11-12 (timeline + milestones)
- **Proposed Modules** → Slide 13-20+ (module_description slides)
- **User Interface & Reporting** → Slide 21-23 (content_bullets)

### Step 3: Generate Slide Structure JSON

Create structured JSON with:
- Project metadata (name, client, total slides)
- Array of slides, each with:
  - slide_number
  - type (title, content_bullets, content_table, two_column, diagram, timeline, module_description)
  - title
  - content (formatted based on type)

### Step 4: Handle Special Cases

- **Architecture Diagram**: If architecture_diagram.md exists, reference it for diagram slides
- **Module Grouping**: Group related modules (e.g., PPE Detection modules) on same slide
- **Content Length**: Split long sections into multiple slides if needed

## Output Format

Generate two files:

1. **`[Project_Name]_slide_structure.json`**: Complete slide structure in JSON format
2. **`[Project_Name]_slide_content.md`**: Human-readable slide content summary (optional, for review)

### JSON Structure:

```json
{
  "project_name": "Project Name",
  "client_name": "Client Name",
  "total_slides": 25,
  "slides": [
    {
      "slide_number": 1,
      "type": "title",
      "title": "Video Analytics Solution Proposal for Client Name",
      "subtitle": "Work Scope",
      "date": "2025-01-15"
    },
    {
      "slide_number": 2,
      "type": "content_table",
      "title": "Project Requirement Statement",
      "table": {
        "headers": ["Field", "Value"],
        "rows": [...]
      }
    }
    // ... more slides
  ]
}
```

## Using Resources

- **When mapping sections**: Reference SLIDE_TEMPLATE.md for slide type definitions and structure
- **When parsing proposal**: Read markdown file and extract sections using headers
- **When formatting content**: Convert markdown lists to bullet points, tables to table format
- **When handling modules**: Group modules by category (PPE, Safety, etc.) per SLIDE_TEMPLATE.md

## Important Rules

### 1. Content Mapping
- Map ALL sections from TEMPLATE.md to slides
- Don't skip any dynamic content
- Handle missing/optional sections gracefully

### 2. Slide Type Selection
- Use appropriate slide type for each content type
- Tables → content_table
- Bullet lists → content_bullets
- Two-column data → two_column
- Timeline → timeline

### 3. Content Formatting
- Convert markdown to clean text (remove markdown syntax)
- Preserve bullet point hierarchy (level 0, 1, 2)
- Format tables properly
- Extract key-value pairs correctly

### 4. Module Handling
- Group modules by category when possible
- One slide per module group
- Include all module fields (Purpose, Alert Logic, Preconditions, etc.)

### 5. Architecture Diagram
- Reference architecture_diagram.md if available
- Include diagram type (mermaid) and code for diagram slides
- Add description if available

## Example Mapping

**Input (TEMPLATE.md)**:
```markdown
## 2. PROJECT REQUIREMENT STATEMENT

| Content | Source/Guidance |
|---------|------------------|
| **Project** | AI-Powered Video Analytics for Safety Monitoring |
| **Project Owner** | Client Name |
| **Camera Number** | 20 cameras |
```

**Output (slide_structure.json)**:
```json
{
  "slide_number": 2,
  "type": "content_table",
  "title": "Project Requirement Statement",
  "table": {
    "headers": ["Field", "Value"],
    "rows": [
      ["Project", "AI-Powered Video Analytics for Safety Monitoring"],
      ["Project Owner", "Client Name"],
      ["Camera Number", "20 cameras"]
    ]
  }
}
```

## Quality Check

Before finalizing, verify:
- ✅ All TEMPLATE.md sections are mapped
- ✅ Slide numbering is continuous (1, 2, 3...)
- ✅ Slide types are appropriate for content
- ✅ Content is properly formatted (no markdown syntax)
- ✅ Modules are grouped logically
- ✅ JSON structure is valid
- ✅ Architecture diagram is referenced if available


